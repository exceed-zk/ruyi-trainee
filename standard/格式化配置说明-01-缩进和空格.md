# 格式化配置说明 - 01 缩进和空格

## 概述
本文档详细说明 Eclipse Java 格式化器中与**缩进和空格**相关的配置项，共约 180 个配置。

## 一、基础缩进配置

### 1.1 缩进大小
```xml
<setting id="org.eclipse.jdt.core.formatter.indentation.size" value="4"/>
```
- **作用**: 设置缩进大小
- **值**: 4 个空格
- **示例**:
```java
public class Test {
    void method() {  // 缩进 4 空格
        if (true) {  // 再缩进 4 空格
            // code
        }
    }
}
```

### 1.2 制表符设置
```xml
<setting id="org.eclipse.jdt.core.formatter.tabulation.char" value="space"/>
<setting id="org.eclipse.jdt.core.formatter.tabulation.size" value="4"/>
```
- **tabulation.char**: 使用空格而非制表符
- **tabulation.size**: 制表符等价于 4 个空格

### 1.3 续行缩进
```xml
<setting id="org.eclipse.jdt.core.formatter.continuation_indentation" value="4"/>
<setting id="org.eclipse.jdt.core.formatter.continuation_indentation_for_array_initializer" value="4"/>
```
- **作用**: 当代码行过长需要换行时的缩进
- **值**: 4 个空格
- **示例**:
```java
String result = someMethod(param1, param2,
        param3, param4);  // 续行缩进 4 空格
```

## 二、空格插入规则

### 2.1 运算符相关空格

#### 赋值运算符
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_assignment_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_assignment_operator" value="insert"/>
```
```java
int x = 5;  // 正确: = 前后都有空格
int y=5;    // 错误
```

#### 算术运算符
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_additive_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_additive_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_multiplicative_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_multiplicative_operator" value="insert"/>
```
```java
int result = a + b * c;  // 正确
int result = a+b*c;      // 错误
```

#### 关系运算符
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_relational_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_relational_operator" value="insert"/>
```
```java
if (x > 5) { }   // 正确
if (x>5) { }     // 错误
```

#### 逻辑运算符
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_logical_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_logical_operator" value="insert"/>
```
```java
if (a && b || c) { }  // 正确
```

#### 位运算符
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_bitwise_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_bitwise_operator" value="insert"/>
```
```java
int mask = flag1 | flag2;  // 正确
```

#### 移位运算符
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_shift_operator" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_shift_operator" value="insert"/>
```
```java
int shifted = value << 2;  // 正确
```

#### 一元运算符
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_prefix_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_prefix_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_postfix_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_postfix_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_unary_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_unary_operator" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_not_operator" value="do not insert"/>
```
```java
++i;    // 正确
i++;    // 正确
!flag;  // 正确
```

### 2.2 逗号和分号

#### 逗号
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_enum_declarations" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_enum_declarations" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_method_invocation_arguments" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_method_invocation_arguments" value="do not insert"/>
```
```java
method(a, b, c);  // 正确: 逗号后有空格,前无空格
method(a,b,c);    // 错误
```

#### 分号
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_semicolon" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_semicolon_in_for" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_semicolon_in_for" value="do not insert"/>
```
```java
int x;                          // 正确: 分号前无空格
for (int i = 0; i < 10; i++) {  // 正确: for 中分号后有空格
}
```

### 2.3 括号相关空格

#### 方法声明
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_method_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_method_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_method_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_parens_in_method_declaration" value="do not insert"/>
```
```java
public void method() { }          // 正确
public void method () { }         // 错误: 方法名后不应有空格
public void method( ) { }         // 错误: 括号内不应有空格
```

#### 方法调用
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_method_invocation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_method_invocation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_method_invocation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_parens_in_method_invocation" value="do not insert"/>
```
```java
method(param);   // 正确
method (param);  // 错误
method( param ); // 错误
```

#### 构造函数
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_constructor_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_constructor_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_constructor_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_parens_in_constructor_declaration" value="do not insert"/>
```

#### 控制语句
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_if" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_if" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_if" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_while" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_while" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_while" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_for" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_for" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_for" value="do not insert"/>
```
```java
if (condition) { }      // 正确: if 后有空格,括号内无空格
while (condition) { }   // 正确
for (int i = 0; i < 10; i++) { }  // 正确
```

#### 其他括号
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_catch" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_switch" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_synchronized" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_try" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_parenthesized_expression" value="do not insert"/>
```
```java
try (Resource r = ...) { }  // 正确: try 后有空格
catch (Exception e) { }      // 正确: catch 后有空格
synchronized (lock) { }      // 正确
```

### 2.4 大括号相关空格

#### 类型声明
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_type_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_enum_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_annotation_type_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_record_declaration" value="insert"/>
```
```java
public class MyClass {      // 正确: 左括号前有空格
public enum MyEnum {        // 正确
public @interface MyAnno {  // 正确
```

#### 方法和构造函数
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_method_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_constructor_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_record_constructor" value="insert"/>
```
```java
public void method() {  // 正确: 左括号前有空格
public MyClass() {      // 正确
```

#### 控制语句和代码块
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_block" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_switch" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_anonymous_type_declaration" value="insert"/>
```
```java
if (x > 0) {         // 正确: 左括号前有空格
switch (value) {     // 正确
new Runnable() {     // 正确
```

#### 数组初始化
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_brace_in_array_initializer" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_brace_in_array_initializer" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_brace_in_array_initializer" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_braces_in_array_initializer" value="do not insert"/>
```
```java
int[] arr = {1, 2, 3};    // 正确
int[] empty = {};         // 正确
```

### 2.5 角括号（泛型）

#### 类型参数
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_angle_bracket_in_type_parameters" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_angle_bracket_in_type_parameters" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_angle_bracket_in_type_parameters" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_closing_angle_bracket_in_type_parameters" value="insert"/>
```
```java
public class MyClass<T> {    // 正确
List<String> list;           // 正确
Map<K, V> map;               // 正确
```

#### 类型参数引用
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_angle_bracket_in_parameterized_type_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_angle_bracket_in_parameterized_type_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_angle_bracket_in_parameterized_type_reference" value="do not insert"/>
```
```java
List<String> list = new ArrayList<>();  // 正确
```

#### 类型参数间
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_type_parameters" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_type_parameters" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_type_arguments" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_type_arguments" value="do not insert"/>
```
```java
Map<String, Integer> map;   // 正确: 逗号后有空格
```

### 2.6 方括号（数组）

```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_bracket_in_array_type_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_brackets_in_array_type_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_bracket_in_array_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_bracket_in_array_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_bracket_in_array_reference" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_bracket_in_array_allocation_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_bracket_in_array_allocation_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_bracket_in_array_allocation_expression" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_between_empty_brackets_in_array_allocation_expression" value="do not insert"/>
```
```java
String[] array;           // 正确
int[][] matrix;           // 正确
String[] arr = new String[10];  // 正确
array[0] = "value";       // 正确: 方括号内外无空格
```

### 2.7 特殊运算符和关键字

#### Lambda 箭头
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_lambda_arrow" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_lambda_arrow" value="insert"/>
```
```java
list.forEach(item -> System.out.println(item));  // 正确
```

#### Switch 箭头
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_arrow_in_switch_case" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_arrow_in_switch_case" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_arrow_in_switch_default" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_arrow_in_switch_default" value="insert"/>
```
```java
switch (value) {
    case 1 -> doSomething();  // 正确: 箭头前后有空格
    default -> doDefault();
}
```

#### 条件运算符
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_question_in_conditional" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_question_in_conditional" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_conditional" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_colon_in_conditional" value="insert"/>
```
```java
String result = (x > 0) ? "positive" : "negative";  // 正确
```

#### 泛型通配符
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_question_in_wildcard" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_question_in_wildcard" value="do not insert"/>
```
```java
List<?> list;                 // 正确
List<? extends Number> list;  // 正确
```

#### 类型参数绑定
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_and_in_type_parameter" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_and_in_type_parameter" value="insert"/>
```
```java
<T extends Comparable<T> & Serializable>  // 正确: & 前后有空格
```

#### 省略号
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_ellipsis" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_ellipsis" value="insert"/>
```
```java
public void method(String... args) {  // 正确
}
```

#### 注解
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_at_in_annotation" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_at_in_annotation_type_declaration" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_at_in_annotation_type_declaration" value="do not insert"/>
```
```java
@Override                  // 正确: @ 后无空格
public @interface MyAnno {  // 正确: @ 前有空格
}
```

#### 冒号
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_case" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_colon_in_case" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_default" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_labeled_statement" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_colon_in_labeled_statement" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_for" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_colon_in_for" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_colon_in_assert" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_colon_in_assert" value="insert"/>
```
```java
case VALUE:            // 正确: case 冒号前无空格,后有空格
default:               // 正确
label: statement;      // 正确: 标签冒号后有空格
for (String s : list) { }  // 正确: for-each 冒号前后都有空格
assert x > 0 : "error";    // 正确: assert 冒号前后都有空格
```

## 三、特殊空格规则

### 3.1 类型转换
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_cast" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_cast" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_closing_paren_in_cast" value="insert"/>
```
```java
String s = (String) obj;  // 正确: 强制转换后有空格
int i = (int)x;           // 错误: 应该在 )x 之间有空格
```

### 3.2 字符串连接
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_string_concatenation" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_string_concatenation" value="insert"/>
```
```java
String s = "Hello" + " " + "World";  // 正确: + 前后有空格
```

### 3.3 Record 组件
```xml
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_comma_in_record_components" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_comma_in_record_components" value="insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_opening_paren_in_record_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_after_opening_paren_in_record_declaration" value="do not insert"/>
<setting id="org.eclipse.jdt.core.formatter.insert_space_before_closing_paren_in_record_declaration" value="do not insert"/>
```
```java
public record Point(int x, int y) { }  // 正确
```

## 四、缩进对齐规则

### 4.1 不使用列对齐
```xml
<setting id="org.eclipse.jdt.core.formatter.align_type_members_on_columns" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.align_variable_declarations_on_columns" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.align_assignment_statements_on_columns" value="false"/>
<setting id="org.eclipse.jdt.core.formatter.align_with_spaces" value="false"/>
```
- **说明**: 不进行列对齐，避免维护成本
```java
// 正确: 不对齐
private int x;
private String name;
private List<String> list;

// 错误: 列对齐（不推荐）
private int          x;
private String       name;
private List<String> list;
```

### 4.2 Switch 语句缩进
```xml
<setting id="org.eclipse.jdt.core.formatter.indent_switchstatements_compare_to_switch" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.indent_switchstatements_compare_to_cases" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.indent_breaks_compare_to_cases" value="true"/>
```
```java
switch (value) {
    case 1:      // 相对 switch 缩进
        doSome(); // 相对 case 缩进
        break;    // break 相对 case 缩进
}
```

### 4.3 代码块缩进
```xml
<setting id="org.eclipse.jdt.core.formatter.indent_statements_compare_to_block" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.indent_statements_compare_to_body" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.indent_body_declarations_compare_to_type_header" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.indent_body_declarations_compare_to_enum_declaration_header" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.indent_body_declarations_compare_to_enum_constant_header" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.indent_body_declarations_compare_to_annotation_declaration_header" value="true"/>
<setting id="org.eclipse.jdt.core.formatter.indent_body_declarations_compare_to_record_header" value="true"/>
```

### 4.4 空行不缩进
```xml
<setting id="org.eclipse.jdt.core.formatter.indent_empty_lines" value="false"/>
```
- **说明**: 空行不添加缩进空格

## 五、总结

### 核心原则

1. ✅ **使用 4 空格缩进**，不使用制表符
2. ✅ **运算符前后加空格**，一元运算符除外
3. ✅ **逗号后加空格**，逗号前不加
4. ✅ **括号内不加空格**，括号外根据上下文决定
5. ✅ **关键字后加空格**（if, while, for 等）
6. ✅ **方法名和括号间不加空格**
7. ✅ **大括号前加空格**
8. ✅ **不使用列对齐**

### 快速参考表

| 位置 | 是否插入空格 | 示例 |
|------|-------------|------|
| 运算符前后 | ✅ 是 | `a + b` |
| 逗号后 | ✅ 是 | `method(a, b)` |
| 逗号前 | ❌ 否 | `method(a, b)` |
| 括号内 | ❌ 否 | `method(x)` |
| if/while/for 后 | ✅ 是 | `if (x)` |
| 方法名后 | ❌ 否 | `method()` |
| 大括号前 | ✅ 是 | `class A {` |
| 分号前 | ❌ 否 | `int x;` |

---

**下一篇**: [格式化配置说明-02-大括号和括号.md](./格式化配置说明-02-大括号和括号.md)
