# RuyiSDK Eclipse IDE 使用手册

## 📋 项目概述

**RuyiSDK Eclipse IDE** 是基于 Eclipse Packaging Project (EPP) 定制的嵌入式 C/C++ 开发环境，专门针对 **RISC-V** 架构进行了优化和扩展。

### 项目特点

- 🎯 基于 Eclipse IDE for Embedded C/C++ Developers
- 💻 支持 **ARM** 和 **RISC-V** 交叉编译
- 🔧 集成多种调试工具（J-Link, OpenOCD, pyocd, QEMU）
- 🌐 支持多平台（Windows, Linux, macOS）
- 📦 开箱即用的项目模板

### 当前版本信息

- **Eclipse 版本**: 2024-12 (4.34.0)
- **Java 要求**: Java 21 或更高版本
- **发布状态**: Release (R)

---

## 🖥️ 系统要求

### 支持的操作系统和架构

| 操作系统 | 架构支持 | 说明 |
|---------|---------|------|
| **Windows** | x86_64, ARM64 | Windows 10/11 |
| **Linux** | x86_64, ARM64, RISC-V | 主流发行版 (Ubuntu, Fedora, etc.) |
| **macOS** | x86_64, ARM64 (Apple Silicon) | macOS 10.15+ |

### 软件依赖

1. **Java Development Kit (JDK)**
   - 最低版本：Java 21
   - 推荐版本：Java 21 LTS
   - 下载地址：[https://adoptium.net/](https://adoptium.net/)

2. **Maven** (仅开发构建需要)
   - 最低版本：Maven 3.9.0
   - 用于从源码构建项目

3. **磁盘空间**
   - 安装空间：约 1.5 GB
   - 工作空间：建议预留 5 GB 以上

4. **内存要求**
   - 最小：4 GB RAM
   - 推荐：8 GB RAM 或更多

---

## 📥 安装和使用方法

### 方法一：使用预构建的发行版（推荐）

#### 步骤 1：下载预构建包

从以下位置下载适合你系统的 RuyiSDK Eclipse IDE 安装包：

- 官方下载站：`https://download.eclipse.org/technology/epp/downloads/release/`
- 根据你的操作系统选择对应的压缩包：
  - Windows: `eclipse-embedcpp-*-win32-x86_64.zip`
  - Linux: `eclipse-embedcpp-*-linux-gtk-x86_64.tar.gz`
  - macOS: `eclipse-embedcpp-*-macosx-cocoa-x86_64.dmg` 或 `.tar.gz`

#### 步骤 2：安装 JDK 21

```bash
# 验证 Java 版本
java -version

# 输出应显示 Java 21 或更高版本
# 例如: openjdk version "21.0.1" 2023-10-17 LTS
```

如果没有安装 Java 21，请从 [Adoptium](https://adoptium.net/) 下载并安装。

#### 步骤 3：解压并运行

**Windows:**
```cmd
# 解压 zip 文件到目标目录
# 双击 ruyisdk.exe 启动 IDE
```

**Linux:**
```bash
# 解压 tar.gz 文件
tar -xzf eclipse-embedcpp-*-linux-gtk-x86_64.tar.gz

# 进入解压目录
cd eclipse

# 运行 IDE
./ruyisdk
```

**macOS:**
```bash
# 挂载 DMG 文件并拖拽到应用程序目录
# 或解压 tar.gz 文件
tar -xzf eclipse-embedcpp-*-macosx-cocoa-x86_64.tar.gz

# 运行
./Eclipse.app/Contents/MacOS/ruyisdk
```

#### 步骤 4：首次启动配置

1. 启动 IDE 后，选择或创建一个工作空间目录
2. **重要提示**：如果从旧版本升级，建议创建新工作空间以避免兼容性问题
3. IDE 将显示欢迎页面，可以开始创建项目

---

### 方法二：从源码构建

如果你需要修改或定制 IDE，可以从源码构建。

#### 前置条件

```bash
# 确保已安装
- Git
- Maven 3.9.0+
- JDK 21+
```

#### 构建步骤

1. **克隆仓库**

```bash
git clone <你的仓库地址>
cd ruyisdk-eclipse-packages
```

2. **构建所有包**

```bash
# 清理并构建所有包
mvn clean verify

# 构建结果位于：
# packages/org.eclipse.epp.package.embedcpp.product/target/products/
```

3. **仅构建 Embedded C/C++ 包**

```bash
mvn clean verify \
  -Pepp.p2.common \
  -Pepp.p2.embedcpp \
  -Pepp.product.embedcpp \
  -Pepp.materialize-products
```

4. **仅构建特定平台**

编辑 `releng/org.eclipse.epp.config/parent/pom.xml`，在 `target-platform-configuration` 中注释掉不需要的平台。

#### Windows 用户特殊说明

如果构建过程在 `verify` 阶段失败，可以尝试仅执行 `package`：

```cmd
mvn clean package -Pepp.package.embedcpp -Pepp.materialize-products
```

#### 构建输出

构建完成后，产物位于：

```
packages/org.eclipse.epp.package.embedcpp.product/target/products/
├── eclipse-embedcpp-*-win32-x86_64.zip
├── eclipse-embedcpp-*-linux-gtk-x86_64.tar.gz
├── eclipse-embedcpp-*-macosx-cocoa-x86_64.tar.gz
└── ... (其他平台)
```

---

## 🚀 使用 IDE 进行开发

### 创建 RISC-V 项目

1. **启动 RuyiSDK Eclipse IDE**

2. **创建新项目**
   - 菜单：`File` → `New` → `C/C++ Project`
   - 选择项目模板（如有 RISC-V 模板）

3. **配置交叉编译工具链**
   - 菜单：`Window` → `Preferences`
   - 导航到：`C/C++` → `Build` → `Environment`
   - 设置 RISC-V 工具链路径

4. **配置调试器**
   - 右键项目 → `Debug As` → `Debug Configurations`
   - 选择调试类型（OpenOCD, QEMU, 等）
   - 配置目标设备和连接参数

### 支持的调试工具

| 调试器 | 用途 | 说明 |
|-------|------|------|
| **SEGGER J-Link** | 硬件调试 | 商业 JTAG 调试器 |
| **OpenOCD** | 硬件调试 | 开源调试服务器 |
| **pyocd** | 硬件调试 | Python 调试工具 |
| **QEMU** | 模拟调试 | 全系统模拟器 |

### 常用功能

#### 1. 导入现有项目

```
File → Import → General → Existing Projects into Workspace
```

#### 2. 配置构建设置

```
Project → Properties → C/C++ Build → Settings
```

#### 3. 更新 IDE 插件

```
Help → Check for Updates
```

---

## 🔧 配置文件说明

### eclipse.ini 配置

IDE 的启动参数配置文件位于安装目录的 `ruyisdk.ini` 或 `eclipse.ini`。

**关键配置项：**

```ini
# JVM 内存设置
-Xms256m          # 最小堆内存
-Xmx2048m         # 最大堆内存（可根据需要调整）

# Java 版本要求
-Dosgi.requiredJavaVersion=21

# 工作空间默认位置
-Dosgi.instance.area.default=@user.home/eclipse-workspace
```

### 插件定制配置

位于 `packages/org.eclipse.epp.package.embedcpp/plugin_customization.ini`

---

## 📦 包含的主要功能

### C/C++ 开发工具 (CDT)

- ✅ 语法高亮和代码补全
- ✅ 代码导航和重构
- ✅ 静态代码分析
- ✅ 内存和性能分析

### 嵌入式开发支持

- ✅ ARM 交叉编译支持
- ✅ **RISC-V 交叉编译支持**
- ✅ 多种调试器集成
- ✅ Blinky 项目模板（快速开始）

### Eclipse CDT-LSP

- ✅ Language Server Protocol 支持
- ✅ 更强大的代码智能提示

### TextMate 4 Eclipse (TM4E)

- ✅ 支持大量编程语言的语法高亮
- ✅ 通用代码编辑器

---

## 🐛 故障排除

### 问题 1：无法启动 IDE

**症状**：双击启动程序无响应

**解决方案**：
```bash
# 检查 Java 版本
java -version

# 确保是 Java 21 或更高版本
# 如果不是，请更新 JAVA_HOME 环境变量
```

### 问题 2：工作空间损坏

**症状**：IDE 启动时报错或功能异常

**解决方案**：
1. 创建新工作空间
2. 使用 `File → Import` 导入旧项目
3. 不要直接复制 `.metadata` 目录

### 问题 3：内存不足

**症状**：IDE 运行缓慢或崩溃

**解决方案**：
编辑 `eclipse.ini`，增加内存分配：
```ini
-Xms512m
-Xmx4096m
```

### 问题 4：插件安装失败

**症状**：安装更新时出错

**解决方案**：
1. 检查网络连接
2. 清理更新站点缓存：`Window → Preferences → Install/Update → Available Software Sites`
3. 重新尝试安装

---

## 📚 进阶使用

### 自定义 IDE 构建

1. **修改包配置**
   - 编辑 `packages/org.eclipse.epp.package.embedcpp.feature/epp.website.xml`
   - 修改包名称、描述等元数据

2. **添加/移除功能**
   - 编辑 `packages/org.eclipse.epp.package.embedcpp.product/epp.product`
   - 添加或移除 Eclipse 功能单元

3. **自定义品牌**
   - 替换 `icons/` 目录下的图标
   - 修改 `about.ini` 和 `about.properties`

### 创建自己的发行包

```bash
# 1. 修改配置文件
# 2. 运行构建
mvn clean verify -Pepp.product.embedcpp

# 3. 产物在 target/products/ 目录
```

---

## 🌐 相关资源

### 官方链接

- **Eclipse Packaging Project**: [https://eclipse.org/epp/](https://eclipse.org/epp/)
- **Eclipse CDT**: [https://eclipse.org/cdt/](https://eclipse.org/cdt/)
- **Embed CDT**: [https://eclipse-embed-cdt.github.io](https://eclipse-embed-cdt.github.io)
- **Eclipse 同步发布**: [https://github.com/eclipse-simrel/.github/blob/main/wiki/Simultaneous_Release.md](https://github.com/eclipse-simrel/.github/blob/main/wiki/Simultaneous_Release.md)

### 问题反馈

- **EPP Issues**: [https://github.com/eclipse-packaging/packages/issues](https://github.com/eclipse-packaging/packages/issues)
- **邮件列表**: [epp-dev@eclipse.org](mailto:epp-dev@eclipse.org)

### 学习资源

- **Eclipse IDE 官方文档**: [https://help.eclipse.org](https://help.eclipse.org)
- **CDT 用户指南**: [https://help.eclipse.org/latest/topic/org.eclipse.cdt.doc.user/](https://help.eclipse.org/latest/topic/org.eclipse.cdt.doc.user/)

---

## 📄 项目文件结构

```
ruyisdk-eclipse-packages/
├── packages/                          # 各种 Eclipse 包配置
│   ├── org.eclipse.epp.package.embedcpp/       # 嵌入式 C/C++ 包
│   │   ├── about.ini                  # 关于信息
│   │   ├── plugin.xml                 # 插件配置
│   │   ├── epp.product               # 产品定义
│   │   └── ...
│   ├── org.eclipse.epp.package.cpp/   # C/C++ 包
│   ├── org.eclipse.epp.package.java/  # Java 包
│   └── ...
├── releng/                            # 发布工程配置
│   └── org.eclipse.epp.config/
│       └── parent/
│           └── pom.xml                # Maven 父配置
├── icons/                             # 图标资源
├── pom.xml                           # 项目根 POM
├── README.md                         # 项目说明
├── RELEASING.md                      # 发布流程文档
├── CONTRIBUTING.md                   # 贡献指南
└── 使用手册.md                        # 本手册
```

---

## 🤝 开发和贡献

### 设置开发环境

1. **导入项目到 Eclipse**
   ```
   File → Import → Maven → Existing Maven Projects
   ```

2. **运行本地构建**
   ```bash
   mvn clean verify
   ```

3. **测试修改**
   - 修改相关配置文件
   - 重新构建并测试生成的 IDE

### 提交贡献

1. Fork 项目仓库
2. 创建功能分支
3. 提交更改
4. 发起 Pull Request

### 代码风格

- 遵循 Eclipse 编码规范
- 使用项目中包含的 `.editorconfig`
- 提交前确保构建通过

---

## 📝 版本历史

### 2024-12 版本新特性

- ✨ 支持 **Windows on ARM** 架构
- ✨ 支持 **Linux on RISC-V** 架构
- ✨ 所有包都包含 TextMate 4 Eclipse (TM4E)
- ✨ Windows 系统默认使用系统信任存储
- ✨ CDT-LSP 集成改进

### 2024-06 版本

- Java 21 成为默认 JVM
- CDT-LSP 首次集成

---

## ⚖️ 许可证

本项目基于 **Eclipse Public License 2.0 (EPL-2.0)** 和 **Eclipse Distribution License v1.0** 许可。

详情请查看项目根目录下的 `LICENSE` 文件。

---

## ❓ 常见问题 (FAQ)

### Q: 这个 IDE 与标准 Eclipse IDE 有什么区别？

A: RuyiSDK Eclipse IDE 是基于 Eclipse IDE for Embedded C/C++ Developers 定制的版本，专门针对 RISC-V 开发进行了优化，集成了特定的工具链和调试器支持。

### Q: 我可以在同一台机器上安装多个版本吗？

A: 可以！只需解压到不同的目录即可。建议为每个版本使用独立的工作空间。

### Q: 如何升级到新版本？

A: 
1. 方法一：下载新版本并使用新工作空间
2. 方法二：使用 `Help → Check for Updates` 在线更新（可能不完整）

推荐方法一以获得完整的新版本体验。

### Q: 支持哪些 RISC-V 开发板？

A: 理论上支持所有 RISC-V 开发板，只需配置相应的工具链和调试器。常见支持的板卡包括：
- HiFive Unmatched
- RISC-V QEMU 虚拟机
- 各种 RISC-V SiFive 开发板

### Q: 构建失败怎么办？

A: 
1. 检查 Maven 版本（需要 3.9.0+）
2. 检查 Java 版本（需要 21+）
3. 清理 Maven 缓存：`mvn clean -Dmaven.clean.failOnError=false`
4. 查看构建日志中的详细错误信息

---

## 📞 获取帮助

如果遇到问题或需要帮助：

1. 📖 查阅本手册的"故障排除"部分
2. 🔍 在 GitHub Issues 中搜索类似问题
3. 💬 在项目讨论区提问
4. 📧 联系维护团队

---

**祝您使用愉快！Happy Coding! 🎉**

---

*最后更新：2024-12*
*文档版本：1.0*

